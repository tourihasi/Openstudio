-- ① 目的：月別にガス・電気の消費エネルギー（J）を同時に取得
SELECT
  t.Month,
  -- ② ガス消費エネルギー（J）
  SUM(
    CASE
      WHEN dd.VariableName = 'NaturalGas:Facility'
      THEN d.VariableValue
      ELSE 0
    END
  ) AS NaturalGas_J,

  -- ③ 電気消費エネルギー（J）
  SUM(
    CASE
      WHEN dd.VariableName = 'Electricity:Facility'
      THEN d.VariableValue
      ELSE 0
    END
  ) AS Electricity_J

FROM
  ReportVariableData d
JOIN
  ReportVariableDataDictionary dd
    ON d.ReportVariableDataDictionaryIndex = dd.ReportVariableDataDictionaryIndex
JOIN
  Time t
    ON d.TimeIndex = t.TimeIndex

-- ④ 対象はガス・電気のみ
WHERE
  dd.VariableName IN (
    'NaturalGas:Facility',
    'Electricity:Facility'
  )

-- ⑤ 月別集計
GROUP BY
  t.Month

ORDER BY
  t.Month;
